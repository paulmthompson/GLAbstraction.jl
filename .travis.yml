language: julia
os:
  - linux
julia:
  - 0.4
sudo: required
branches:
  only:
    - sd/nextÂ²
notifications:
  email: false
addons:
   apt:
      sources:
         - kubuntu-backports
      packages:
         - xvfb
         - xauth
         - libgtk-3-0
         - cmake
         - libxxf86vm-dev
         - libx11-dev
         - xorg-dev
         - opencl-headers
         - libglew-dev
         - libosmesa6-dev
         - libglu1-mesa-dev
         - libgl1-mesa-dev
         - libxcursor-dev
before install:
  - "/sbin/start-stop-daemon --start --quiet --pidfile /tmp/custom_xvfb_963.pid --make-pidfile --background --exec /usr/bin/Xvfb -- :963 -ac -screen 0 800x600x16 --use-gl=osmesa"
script:
  - if [[ -a .git/shallow ]]; then git fetch --unshallow; fi
  - julia ./test/prepare_tests.jl
  - sudo mkdir /dev/input
  - julia --check-bounds=yes --depwarn=no -e 'Pkg.clone(pwd()); Pkg.build("GLAbstraction"); Pkg.test("GLAbstraction"; coverage=true)'
