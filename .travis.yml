language: julia
os:
  - linux
julia:
  - 0.4
sudo: required
branches:
  only:
    - sd/nextÂ²
notifications:
  email: false
addons:
   apt:
      sources:
         - kubuntu-backports
      packages:
         - xvfb
         - xauth
         - libgtk-3-0
         - cmake
         - libxxf86vm-dev
         - libx11-dev
         - xorg-dev
         - opencl-headers
         - libglew-dev
         - libosmesa6-dev
         - libglu1-mesa-dev
         - libgl1-mesa-dev
before_script:
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
script:
  - if [[ -a .git/shallow ]]; then git fetch --unshallow; fi
  - julia ./test/prepare_tests.jl
  - sudo mkdir /dev/input
  - julia --check-bounds=yes --depwarn=no -e 'Pkg.clone(pwd()); Pkg.build("GLAbstraction"); Pkg.test("GLAbstraction"; coverage=true)'
